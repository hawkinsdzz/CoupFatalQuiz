<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Duel - Coup Fatal (Encyclopédie Stable)</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: #0f172a;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            user-select: none;
        }

        /* Fond animé */
        .bg-animated {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            background: linear-gradient(125deg, #0f172a, #1e1b4b, #312e81, #0f172a);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            transition: filter 0.5s ease;
        }

        .sudden-death-bg {
            background: linear-gradient(125deg, #450a0a, #7f1d1d, #991b1b, #450a0a);
            animation: gradientBG 2s ease infinite !important;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .timer-active {
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.6);
            border-color: #3b82f6;
            transform: scale(1.02);
            z-index: 10;
        }

        /* Mode Danger (< 10s) */
        .timer-danger {
            animation: pulse-red 1s infinite;
            border-color: #ef4444;
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.8);
        }

        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        .card-glass {
            background: rgba(30, 41, 59, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* Animation Pénalité -2s */
        @keyframes floatUpFade {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-40px) scale(1.5); }
        }
        .penalty-anim {
            position: absolute;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ef4444;
            font-size: 4rem;
            font-weight: 900;
            text-shadow: 0 0 20px black;
            animation: floatUpFade 0.8s ease-out forwards;
            pointer-events: none;
            z-index: 50;
        }

        .category-btn { transition: all 0.2s; }
        .category-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        
        .category-selected {
            background: linear-gradient(to right, #eab308, #f59e0b);
            color: #0f172a;
            border-color: #f59e0b;
            font-weight: 900;
        }

        .btn-pulse { animation: pulse-green 2s infinite; }
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }

        /* Avatar styles */
        .avatar-container {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            margin-bottom: -40px;
            z-index: 20;
            background-color: #1e293b;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Badges Difficulté */
        .badge-Facile { background-color: #22c55e; color: #052e16; }
        .badge-Moyen { background-color: #eab308; color: #422006; }
        .badge-Difficile { background-color: #f97316; color: #431407; }
        .badge-Expert { background-color: #ef4444; color: #450a0a; border: 1px solid #7f1d1d; }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
    </style>
</head>
<body>
    <div id="bg-layer" class="bg-animated"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        // --- CONSTANTES ---
        const SOUNDS = {
            CORRECT: { freq: 880, type: 'sine', duration: 0.1 },
            WRONG: { freq: 150, type: 'sawtooth', duration: 0.3 },
            JOKER: { freq: 600, type: 'triangle', duration: 0.4 },
            END: { freq: 100, type: 'triangle', duration: 1 },
            BEAT_LOW: { freq: 100, type: 'sine', duration: 0.05 },
            BEAT_HIGH: { freq: 200, type: 'square', duration: 0.05 },
            UNDO: { freq: 300, type: 'sine', duration: 0.2 }
        };

        const INITIAL_CATEGORIES = {
            ALL: "TOUT MÉLANGER",
            ANIME: "Animés & Mangas",
            HISTOIRE: "Histoire",
            GEO: "Géographie",
            SPORT: "Sport",
            CINEMA: "Cinéma & Séries",
            MUSIQUE: "Musique",
            JEUX: "Jeux Vidéo",
            SCIENCES: "Sciences & Nature",
            LITTERATURE: "Littérature & BD"
        };

        const HISTORY_STORAGE_KEY = 'coup_fatal_question_history_log';
        const MAX_HISTORY_SIZE = 200;

        // --- DONNEES POUR GENERATEUR (Infinies) ---
        const DATA_SETS = {
            COUNTRIES: [
                ["France", "Paris", "Moyen"], ["Espagne", "Madrid", "Facile"], ["Allemagne", "Berlin", "Facile"], ["Italie", "Rome", "Facile"], 
                ["Royaume-Uni", "Londres", "Facile"], ["Belgique", "Bruxelles", "Moyen"], ["Suisse", "Berne", "Difficile"], ["Portugal", "Lisbonne", "Moyen"],
                ["Pays-Bas", "Amsterdam", "Moyen"], ["Grèce", "Athènes", "Moyen"], ["Russie", "Moscou", "Facile"], ["Chine", "Pékin", "Facile"],
                ["Japon", "Tokyo", "Facile"], ["Corée du Sud", "Séoul", "Moyen"], ["Inde", "New Delhi", "Moyen"], ["Thaïlande", "Bangkok", "Moyen"],
                ["Vietnam", "Hanoï", "Difficile"], ["Australie", "Canberra", "Difficile"], ["Nouvelle-Zélande", "Wellington", "Expert"], ["USA", "Washington D.C.", "Facile"],
                ["Canada", "Ottawa", "Moyen"], ["Mexique", "Mexico", "Facile"], ["Brésil", "Brasilia", "Difficile"], ["Argentine", "Buenos Aires", "Moyen"],
                ["Chili", "Santiago", "Moyen"], ["Colombie", "Bogota", "Difficile"], ["Pérou", "Lima", "Moyen"], ["Égypte", "Le Caire", "Facile"],
                ["Maroc", "Rabat", "Difficile"], ["Algérie", "Alger", "Moyen"], ["Tunisie", "Tunis", "Facile"], ["Afrique du Sud", "Pretoria", "Expert"],
                ["Sénégal", "Dakar", "Moyen"], ["Côte d'Ivoire", "Yamoussoukro", "Expert"], ["Kenya", "Nairobi", "Difficile"], ["Turquie", "Ankara", "Difficile"],
                ["Suède", "Stockholm", "Moyen"], ["Norvège", "Oslo", "Moyen"], ["Finlande", "Helsinki", "Difficile"], ["Danemark", "Copenhague", "Moyen"]
            ],
            ELEMENTS: [
                ["H", "Hydrogène", "Facile"], ["He", "Hélium", "Facile"], ["Li", "Lithium", "Moyen"], ["C", "Carbone", "Facile"], ["N", "Azote", "Moyen"],
                ["O", "Oxygène", "Facile"], ["F", "Fluor", "Difficile"], ["Ne", "Néon", "Moyen"], ["Na", "Sodium", "Difficile"], ["Mg", "Magnésium", "Moyen"],
                ["Al", "Aluminium", "Facile"], ["Si", "Silicium", "Moyen"], ["P", "Phosphore", "Difficile"], ["S", "Soufre", "Difficile"], ["Cl", "Chlore", "Moyen"],
                ["K", "Potassium", "Difficile"], ["Ca", "Calcium", "Moyen"], ["Fe", "Fer", "Facile"], ["Cu", "Cuivre", "Moyen"], ["Zn", "Zinc", "Moyen"],
                ["Ag", "Argent", "Moyen"], ["Au", "Or", "Facile"], ["Hg", "Mercure", "Difficile"], ["Pb", "Plomb", "Difficile"], ["U", "Uranium", "Moyen"]
            ],
            AUTHORS: [
                ["Les Misérables", "Victor Hugo", "Facile"], ["Notre-Dame de Paris", "Victor Hugo", "Facile"], ["L'Étranger", "Albert Camus", "Moyen"],
                ["La Peste", "Albert Camus", "Moyen"], ["Madame Bovary", "Gustave Flaubert", "Moyen"], ["Le Rouge et le Noir", "Stendhal", "Difficile"],
                ["Les Fleurs du Mal", "Charles Baudelaire", "Facile"], ["Une Saison en Enfer", "Arthur Rimbaud", "Difficile"], ["Germinal", "Émile Zola", "Moyen"],
                ["Nana", "Émile Zola", "Moyen"], ["Vingt mille lieues sous les mers", "Jules Verne", "Facile"], ["Le Tour du monde en 80 jours", "Jules Verne", "Facile"],
                ["Les Trois Mousquetaires", "Alexandre Dumas", "Facile"], ["Le Comte de Monte-Cristo", "Alexandre Dumas", "Moyen"], ["À la recherche du temps perdu", "Marcel Proust", "Expert"],
                ["Le Petit Prince", "Antoine de Saint-Exupéry", "Facile"], ["Antigone", "Jean Anouilh", "Difficile"], ["En attendant Godot", "Samuel Beckett", "Expert"],
                ["Cyrano de Bergerac", "Edmond Rostand", "Moyen"], ["Le Malade imaginaire", "Molière", "Facile"], ["L'Avare", "Molière", "Facile"],
                ["1984", "George Orwell", "Moyen"], ["Le Seigneur des Anneaux", "J.R.R. Tolkien", "Facile"], ["Harry Potter", "J.K. Rowling", "Facile"]
            ]
        };

        // --- LISTE STATIQUE MASSIVE (Culture G, Histoire, Sport, etc.) ---
        const BASE_QUESTIONS = [
            // === ANIMES & MANGAS ===
            { category: "Animés & Mangas", difficulty: "Facile", question: "Quel est le nom du héros de One Piece ?", answer: "Luffy" },
            { category: "Animés & Mangas", difficulty: "Facile", question: "Quel est le prénom de Goku ?", answer: "Son Goku" },
            { category: "Animés & Mangas", difficulty: "Facile", question: "Quel Pokémon est jaune et lance des éclairs ?", answer: "Pikachu" },
            { category: "Animés & Mangas", difficulty: "Facile", question: "Dans Naruto, quel est le nom du village caché des feuilles ?", answer: "Konoha" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Comment s'appelle le cahier de la mort dans Death Note ?", answer: "Le Death Note" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Dans l'Attaque des Titans, que mangent les Titans ?", answer: "Des humains" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Quel est le nom du studio de Miyazaki ?", answer: "Studio Ghibli" },
            { category: "Animés & Mangas", difficulty: "Difficile", question: "Quel pirate de l'espace a une cicatrice au visage ?", answer: "Albator" },
            { category: "Animés & Mangas", difficulty: "Difficile", question: "Qui est le frère d'Edward Elric ?", answer: "Alphonse" },
            { category: "Animés & Mangas", difficulty: "Difficile", question: "Quel est le nom du robot géant piloté par Actarus ?", answer: "Goldorak" },
            { category: "Animés & Mangas", difficulty: "Expert", question: "Quel est le vrai nom de L dans Death Note ?", answer: "L Lawliet" },
            { category: "Animés & Mangas", difficulty: "Expert", question: "Dans One Piece, quel est le nom de l'épée maudite de Zoro ?", answer: "Sandai Kitetsu" },
            { category: "Animés & Mangas", difficulty: "Facile", question: "Quel est le fruit du démon de Luffy ?", answer: "Gomu Gomu no Mi" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Qui est l'auteur de Dragon Ball ?", answer: "Akira Toriyama" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Dans quel anime trouve-t-on le Titan Colossal ?", answer: "L'Attaque des Titans" },
            { category: "Animés & Mangas", difficulty: "Difficile", question: "Quel est le nom du père de Naruto ?", answer: "Minato Namikaze" },
            { category: "Animés & Mangas", difficulty: "Difficile", question: "Dans Bleach, quel est le nom du zanpakuto d'Ichigo ?", answer: "Zangetsu" },
            { category: "Animés & Mangas", difficulty: "Expert", question: "Quel est le nom du vaisseau de Spike Spiegel ?", answer: "Swordfish 2" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Qui est le personnage principal de My Hero Academia ?", answer: "Izuku Midoriya" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Quel est le nom du démon renard à 9 queues ?", answer: "Kyûbi (Kurama)" },
            { category: "Animés & Mangas", difficulty: "Facile", question: "Comment s'appelle la soeur de Tanjiro ?", answer: "Nezuko" },
            { category: "Animés & Mangas", difficulty: "Difficile", question: "Qui est le créateur de One Piece ?", answer: "Eiichiro Oda" },
            { category: "Animés & Mangas", difficulty: "Facile", question: "Quelle couleur sont les cheveux de Bulma ?", answer: "Bleu" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Quel est le prénom de Light dans Death Note ?", answer: "Light" },
            { category: "Animés & Mangas", difficulty: "Facile", question: "Qui est le rival de Sacha dans Pokémon ?", answer: "Régis" },
            { category: "Animés & Mangas", difficulty: "Expert", question: "Quel est le numéro de C-18 ?", answer: "18" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Dans One Punch Man, quel est le rang de Saitama au début ?", answer: "Classe C" },
            { category: "Animés & Mangas", difficulty: "Difficile", question: "Qui est le père de Gon Freecss ?", answer: "Ging Freecss" },
            { category: "Animés & Mangas", difficulty: "Expert", question: "Quel est le nom du titan d'Armin ?", answer: "Le Titan Colossal" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Qui a mangé le fruit du feu dans One Piece ?", answer: "Ace" },
            { category: "Animés & Mangas", difficulty: "Difficile", question: "Quel est le nom du Stand de Jotaro ?", answer: "Star Platinum" },
            { category: "Animés & Mangas", difficulty: "Facile", question: "Quel animal est Chopper ?", answer: "Un renne" },
            { category: "Animés & Mangas", difficulty: "Moyen", question: "Qui est le maître de Goku enfant ?", answer: "Tortue Géniale" },
            { category: "Animés & Mangas", difficulty: "Difficile", question: "Quel est le nom de l'épée de Guts ?", answer: "Dragon Slayer" },
            { category: "Animés & Mangas", difficulty: "Expert", question: "Quel est le nom de la forme finale de Freezer ?", answer: "Golden Freezer" },

            // --- HISTOIRE ---
            { category: "Histoire", difficulty: "Facile", question: "Qui était le 'Roi Soleil' ?", answer: "Louis 14" },
            { category: "Histoire", difficulty: "Facile", question: "Qui a découvert l'Amérique en 1492 ?", answer: "Christophe Colomb" },
            { category: "Histoire", difficulty: "Facile", question: "En quelle année a commencé la Révolution française ?", answer: "1789" },
            { category: "Histoire", difficulty: "Moyen", question: "Quelle année marque la chute du Mur de Berlin ?", answer: "1989" },
            { category: "Histoire", difficulty: "Moyen", question: "Quel empereur français est mort à Sainte-Hélène ?", answer: "Napoléon 1er" },
            { category: "Histoire", difficulty: "Difficile", question: "Qui a construit la Tour Eiffel ?", answer: "Gustave Eiffel" },
            { category: "Histoire", difficulty: "Difficile", question: "Quelle guerre a opposé le Nord et le Sud des USA ?", answer: "La guerre de Sécession" },
            { category: "Histoire", difficulty: "Expert", question: "En quelle année Charlemagne a-t-il été sacré empereur ?", answer: "800" },
            { category: "Histoire", difficulty: "Expert", question: "Qui était le premier roi des Francs ?", answer: "Clovis" },
            { category: "Histoire", difficulty: "Facile", question: "Qui a été le premier président de la 5e République ?", answer: "Charles de Gaulle" },
            { category: "Histoire", difficulty: "Facile", question: "Quelle guerre s'est terminée en 1945 ?", answer: "La 2e Guerre Mondiale" },
            { category: "Histoire", difficulty: "Moyen", question: "Qui était la femme de Louis 16 ?", answer: "Marie-Antoinette" },
            { category: "Histoire", difficulty: "Moyen", question: "Qui a inventé l'imprimerie ?", answer: "Gutenberg" },
            { category: "Histoire", difficulty: "Difficile", question: "Qui a peint le plafond de la Chapelle Sixtine ?", answer: "Michel-Ange" },
            { category: "Histoire", difficulty: "Difficile", question: "En quelle année a eu lieu la bataille de Waterloo ?", answer: "1815" },
            { category: "Histoire", difficulty: "Expert", question: "Quel traité a mis fin à la 1ère Guerre Mondiale ?", answer: "Traité de Versailles" },
            { category: "Histoire", difficulty: "Facile", question: "Quel pays a offert la Statue de la Liberté aux USA ?", answer: "La France" },
            { category: "Histoire", difficulty: "Moyen", question: "Qui a prononcé l'appel du 18 juin ?", answer: "Général de Gaulle" },
            { category: "Histoire", difficulty: "Moyen", question: "Quel est le nom du bateau de Christophe Colomb ?", answer: "La Santa Maria" },
            { category: "Histoire", difficulty: "Difficile", question: "Qui était le chef des Huns ?", answer: "Attila" },
            { category: "Histoire", difficulty: "Expert", question: "Quel roi de France a régné le plus longtemps ?", answer: "Louis 14" },
            { category: "Histoire", difficulty: "Moyen", question: "Quelle ville a été détruite par le Vésuve ?", answer: "Pompéi" },
            { category: "Histoire", difficulty: "Facile", question: "Qui a marché le premier sur la Lune ?", answer: "Neil Armstrong" },
            { category: "Histoire", difficulty: "Difficile", question: "Quel président américain a aboli l'esclavage ?", answer: "Abraham Lincoln" },
            { category: "Histoire", difficulty: "Expert", question: "En quelle année est mort Napoléon ?", answer: "1821" },
            { category: "Histoire", difficulty: "Moyen", question: "Qui a succédé à Louis 14 ?", answer: "Louis 15" },
            { category: "Histoire", difficulty: "Facile", question: "Quelle civilisation a construit les pyramides ?", answer: "Les Égyptiens" },
            { category: "Histoire", difficulty: "Difficile", question: "Qui était le roi d'Angleterre aux 6 femmes ?", answer: "Henri 8" },
            { category: "Histoire", difficulty: "Expert", question: "Quel roi a révoqué l'Édit de Nantes ?", answer: "Louis 14" },
            { category: "Histoire", difficulty: "Moyen", question: "En quelle année a eu lieu la prise de la Bastille ?", answer: "1789" },
            { category: "Histoire", difficulty: "Facile", question: "Qui a dit 'Veni Vidi Vici' ?", answer: "Jules César" },
            { category: "Histoire", difficulty: "Difficile", question: "Quel est le prénom de Molière ?", answer: "Jean-Baptiste" },
            { category: "Histoire", difficulty: "Expert", question: "Combien de temps a duré la guerre de 100 ans ?", answer: "116 ans" },
            { category: "Histoire", difficulty: "Moyen", question: "Qui a découvert la pénicilline ?", answer: "Fleming" },
            { category: "Histoire", difficulty: "Expert", question: "Qui était le dernier Tsar de Russie ?", answer: "Nicolas 2" },
            { category: "Histoire", difficulty: "Expert", question: "Qui a écrit le Code Civil ?", answer: "Napoléon 1er" },
            { category: "Histoire", difficulty: "Facile", question: "Qui a découvert la gravité avec une pomme ?", answer: "Newton" },
            { category: "Histoire", difficulty: "Moyen", question: "Quelle est la date de l'armistice de 1918 ?", answer: "11 novembre" },
            { category: "Histoire", difficulty: "Difficile", question: "Qui a été le premier président des USA ?", answer: "George Washington" },
            { category: "Histoire", difficulty: "Expert", question: "Qui a assassiné Henri 4 ?", answer: "Ravaillac" },
            { category: "Histoire", difficulty: "Moyen", question: "Quel pays a attaqué Pearl Harbor ?", answer: "Le Japon" },
            { category: "Histoire", difficulty: "Facile", question: "Qui était Jeanne d'Arc ?", answer: "Une héroïne française" },
            { category: "Histoire", difficulty: "Difficile", question: "En quelle année l'homme a marché sur la lune ?", answer: "1969" },

            // --- GÉOGRAPHIE ---
            { category: "Géographie", difficulty: "Moyen", question: "Quelle est la capitale de l'Australie ?", answer: "Canberra" },
            { category: "Géographie", difficulty: "Facile", question: "Quel est le plus grand pays du monde ?", answer: "La Russie" },
            { category: "Géographie", difficulty: "Moyen", question: "Dans quel pays se trouve le Taj Mahal ?", answer: "L'Inde" },
            { category: "Géographie", difficulty: "Moyen", question: "Quelle est la capitale du Canada ?", answer: "Ottawa" },
            { category: "Géographie", difficulty: "Facile", question: "Quel continent est le plus froid ?", answer: "L'Antarctique" },
            { category: "Géographie", difficulty: "Difficile", question: "Quelle chaîne de montagnes sépare la France et l'Espagne ?", answer: "Les Pyrénées" },
            { category: "Géographie", difficulty: "Difficile", question: "Quelle est la capitale de la Turquie ?", answer: "Ankara" },
            { category: "Géographie", difficulty: "Expert", question: "Quelle est la capitale du Kazakhstan ?", answer: "Astana" },
            { category: "Géographie", difficulty: "Expert", question: "Quel pays possède le plus d'îles au monde ?", answer: "La Suède" },
            { category: "Géographie", difficulty: "Facile", question: "Quelle est la capitale de la France ?", answer: "Paris" },
            { category: "Géographie", difficulty: "Facile", question: "Quel pays a la forme d'une botte ?", answer: "L'Italie" },
            { category: "Géographie", difficulty: "Moyen", question: "Quelle est la monnaie du Japon ?", answer: "Le Yen" },
            { category: "Géographie", difficulty: "Moyen", question: "Sur quel continent se trouve le Brésil ?", answer: "Amérique du Sud" },
            { category: "Géographie", difficulty: "Difficile", question: "Quel est le plus long fleuve du monde ?", answer: "L'Amazone" },
            { category: "Géographie", difficulty: "Difficile", question: "Quelle est la capitale de la Suisse ?", answer: "Berne" },
            { category: "Géographie", difficulty: "Expert", question: "Quel est le pays le plus peuplé d'Afrique ?", answer: "Le Nigeria" },
            { category: "Géographie", difficulty: "Facile", question: "Quelle est la capitale de l'Angleterre ?", answer: "Londres" },
            { category: "Géographie", difficulty: "Moyen", question: "Où se trouve la Tour de Pise ?", answer: "En Italie" },
            { category: "Géographie", difficulty: "Moyen", question: "Quel océan borde la Californie ?", answer: "Pacifique" },
            { category: "Géographie", difficulty: "Difficile", question: "Quel détroit sépare l'Espagne du Maroc ?", answer: "Gibraltar" },
            { category: "Géographie", difficulty: "Expert", question: "Quelle est la capitale de la Nouvelle-Zélande ?", answer: "Wellington" },
            { category: "Géographie", difficulty: "Facile", question: "Quel est le plus grand désert chaud ?", answer: "Sahara" },
            { category: "Géographie", difficulty: "Moyen", question: "Quelle est la capitale de l'Allemagne ?", answer: "Berlin" },
            { category: "Géographie", difficulty: "Difficile", question: "Quel pays a pour capitale Hanoï ?", answer: "Vietnam" },
            { category: "Géographie", difficulty: "Expert", question: "Quel est le plus petit pays du monde ?", answer: "Le Vatican" },
            { category: "Géographie", difficulty: "Moyen", question: "Quelle est la capitale de la Belgique ?", answer: "Bruxelles" },
            { category: "Géographie", difficulty: "Facile", question: "Dans quel pays se trouve New York ?", answer: "USA" },
            { category: "Géographie", difficulty: "Difficile", question: "Quelle est la capitale du Maroc ?", answer: "Rabat" },
            { category: "Géographie", difficulty: "Expert", question: "Quelle est la capitale de la Bolivie ?", answer: "La Paz (et Sucre)" },
            { category: "Géographie", difficulty: "Moyen", question: "Quel fleuve traverse l'Égypte ?", answer: "Le Nil" },
            { category: "Géographie", difficulty: "Facile", question: "Quelle est la monnaie de l'Europe ?", answer: "L'Euro" },
            { category: "Géographie", difficulty: "Difficile", question: "Quel est le plus haut sommet d'Europe ?", answer: "Le Mont Blanc" },
            { category: "Géographie", difficulty: "Expert", question: "Quel pays a pour capitale Oulan-Bator ?", answer: "La Mongolie" },
            { category: "Géographie", difficulty: "Moyen", question: "Où se trouve le Machu Picchu ?", answer: "Au Pérou" },
            { category: "Géographie", difficulty: "Facile", question: "Quelle est la capitale de l'Espagne ?", answer: "Madrid" },
            { category: "Géographie", difficulty: "Difficile", question: "Quel pays est surnommé le pays des cèdres ?", answer: "Le Liban" },
            { category: "Géographie", difficulty: "Expert", question: "Quelle est la capitale de l'Islande ?", answer: "Reykjavik" },
            { category: "Géographie", difficulty: "Moyen", question: "Quel pays a pour capitale Pékin ?", answer: "La Chine" },
            { category: "Géographie", difficulty: "Facile", question: "Sur quel continent est le Kenya ?", answer: "Afrique" },
            { category: "Géographie", difficulty: "Difficile", question: "Quel est le plus grand lac d'Afrique ?", answer: "Lac Victoria" },
            { category: "Géographie", difficulty: "Expert", question: "Quelle est la capitale du Venezuela ?", answer: "Caracas" },
            { category: "Géographie", difficulty: "Moyen", question: "Dans quel pays se trouve la Bavière ?", answer: "Allemagne" },
            { category: "Géographie", difficulty: "Facile", question: "Quelle mer borde le sud de la France ?", answer: "Méditerranée" },
            { category: "Géographie", difficulty: "Difficile", question: "Quelle est la capitale de la Colombie ?", answer: "Bogota" },
            { category: "Géographie", difficulty: "Expert", question: "Quel pays a pour capitale Manille ?", answer: "Les Philippines" },

             // --- SPORT ---
            { category: "Sport", difficulty: "Facile", question: "Quel pays a gagné la coupe du monde de foot 1998 ?", answer: "La France" },
            { category: "Sport", difficulty: "Facile", question: "Quel sport pratique Rafael Nadal ?", answer: "Le Tennis" },
            { category: "Sport", difficulty: "Moyen", question: "Combien de joueurs dans une équipe de basket ?", answer: "5" },
            { category: "Sport", difficulty: "Difficile", question: "Dans quel sport utilise-t-on une crosse et un palet ?", answer: "Hockey sur glace" },
            { category: "Sport", difficulty: "Moyen", question: "Quel est le sport de Teddy Riner ?", answer: "Le Judo" },
            { category: "Sport", difficulty: "Expert", question: "Quelle est la distance d'un marathon ?", answer: "42,195 km" },
            { category: "Sport", difficulty: "Expert", question: "Qui a remporté le Tour de France en 1985 ?", answer: "Bernard Hinault" },
            { category: "Sport", difficulty: "Facile", question: "Quel est le club de foot de Paris ?", answer: "PSG" },
            { category: "Sport", difficulty: "Facile", question: "Quel sport se joue avec un ballon ovale ?", answer: "Rugby" },
            { category: "Sport", difficulty: "Moyen", question: "Combien de temps dure un match de foot ?", answer: "90 minutes" },
            { category: "Sport", difficulty: "Moyen", question: "Quel nageur a le plus de médailles olympiques ?", answer: "Michael Phelps" },
            { category: "Sport", difficulty: "Difficile", question: "Dans quel sport utilise-t-on un fleuret ?", answer: "Escrime" },
            { category: "Sport", difficulty: "Difficile", question: "Combien de quilles au bowling ?", answer: "10" },
            { category: "Sport", difficulty: "Expert", question: "Quel est le record du 100m homme ?", answer: "9.58s" },
            { category: "Sport", difficulty: "Facile", question: "Quel sport pratique Tony Parker ?", answer: "Basketball" },
            { category: "Sport", difficulty: "Moyen", question: "Quel pays a gagné la coupe du monde 2018 ?", answer: "La France" },
            { category: "Sport", difficulty: "Moyen", question: "Quel est le surnom de l'équipe de Nouvelle-Zélande ?", answer: "All Blacks" },
            { category: "Sport", difficulty: "Difficile", question: "Où ont eu lieu les JO de 2008 ?", answer: "Pékin" },
            { category: "Sport", difficulty: "Expert", question: "Combien de titres de F1 a Lewis Hamilton ?", answer: "7" },
            { category: "Sport", difficulty: "Facile", question: "Quel objet s'échange-t-on au ping-pong ?", answer: "Une balle" },
            { category: "Sport", difficulty: "Moyen", question: "Sur quelle surface se joue Wimbledon ?", answer: "Gazon" },
            { category: "Sport", difficulty: "Difficile", question: "Quel est le sport national du Japon (lutte) ?", answer: "Sumo" },
            { category: "Sport", difficulty: "Expert", question: "Qui a gagné Roland Garros en 1983 ?", answer: "Yannick Noah" },
            { category: "Sport", difficulty: "Facile", question: "Quel est le maillot du leader du Tour de France ?", answer: "Jaune" },
            { category: "Sport", difficulty: "Moyen", question: "Combien de joueurs dans une équipe de volley ?", answer: "6" },
            { category: "Sport", difficulty: "Moyen", question: "Quel sport pratique Tiger Woods ?", answer: "Golf" },
            { category: "Sport", difficulty: "Facile", question: "Quel pays a gagné la coupe du monde de rugby 2023 ?", answer: "Afrique du Sud" },
            { category: "Sport", difficulty: "Difficile", question: "Combien de périodes dans un match de hockey ?", answer: "3" },
            { category: "Sport", difficulty: "Expert", question: "Qui détient le record de saut à la perche (2024) ?", answer: "Duplantis" },
            { category: "Sport", difficulty: "Facile", question: "Quel sport se joue sur un tatami ?", answer: "Judo" },
            { category: "Sport", difficulty: "Moyen", question: "Combien de trous sur un parcours de golf ?", answer: "18" },
            { category: "Sport", difficulty: "Difficile", question: "Quel est le surnom de l'équipe de foot du Brésil ?", answer: "Seleção" },
            { category: "Sport", difficulty: "Expert", question: "En quelle année Zidane a mis son coup de boule ?", answer: "2006" },
            { category: "Sport", difficulty: "Moyen", question: "Quelle ville organise les JO 2024 ?", answer: "Paris" },
            { category: "Sport", difficulty: "Facile", question: "Quel sport pratique LeBron James ?", answer: "Basketball" },
            { category: "Sport", difficulty: "Difficile", question: "Combien de points vaut un essai transformé au rugby ?", answer: "7" },
            { category: "Sport", difficulty: "Expert", question: "Qui a gagné le Tour de France 2023 ?", answer: "Vingegaard" },
            { category: "Sport", difficulty: "Moyen", question: "Quel est le sport de Sébastien Loeb ?", answer: "Rallye" },
            { category: "Sport", difficulty: "Facile", question: "Avec quoi frappe-t-on la balle au baseball ?", answer: "Une batte" },
            { category: "Sport", difficulty: "Difficile", question: "Combien de joueurs au handball sur le terrain ?", answer: "7" },
            { category: "Sport", difficulty: "Expert", question: "Quel pays a gagné la première coupe du monde de foot ?", answer: "Uruguay" },
            { category: "Sport", difficulty: "Moyen", question: "Quel est le surnom de Michael Jordan ?", answer: "Air Jordan" },
            { category: "Sport", difficulty: "Facile", question: "Quel sport se joue dans un ring ?", answer: "Boxe" },
            { category: "Sport", difficulty: "Difficile", question: "Quelle est la distance d'un sprint court ?", answer: "100m" },
            { category: "Sport", difficulty: "Expert", question: "Combien de fois le Brésil a gagné la coupe du monde ?", answer: "5" },

            // --- CINÉMA & SÉRIES ---
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Qui a réalisé Titanic ?", answer: "James Cameron" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Dans quel film entend-on 'Je suis ton père' ?", answer: "Star Wars" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quel est le nom du lion dans Le Roi Lion ?", answer: "Simba" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quel est le nom de l'extra-terrestre de Spielberg ?", answer: "E.T." },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quel est le nom du poisson clown perdu ?", answer: "Nemo" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quelle série met en scène une famille jaune ?", answer: "Les Simpson" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Qui joue Jack Sparrow ?", answer: "Johnny Depp" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Dans quelle ville se passe Batman ?", answer: "Gotham City" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Quel acteur joue Wolverine ?", answer: "Hugh Jackman" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Dans Matrix, qui joue Neo ?", answer: "Keanu Reeves" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Quel film se passe dans un parc de dinosaures ?", answer: "Jurassic Park" },
            { category: "Cinéma & Séries", difficulty: "Difficile", question: "Qui a réalisé Pulp Fiction ?", answer: "Quentin Tarantino" },
            { category: "Cinéma & Séries", difficulty: "Difficile", question: "Quel est le nom de l'ordinateur dans 2001 l'Odyssée de l'espace ?", answer: "HAL 9000" },
            { category: "Cinéma & Séries", difficulty: "Expert", question: "Quel est le premier film parlant de l'histoire ?", answer: "Le Chanteur de Jazz" },
            { category: "Cinéma & Séries", difficulty: "Expert", question: "Qui a réalisé le film 'Les Oiseaux' ?", answer: "Alfred Hitchcock" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quel est le prénom de l'ogre vert ?", answer: "Shrek" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Qui est le méchant dans Harry Potter ?", answer: "Voldemort" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Quel est le métier de Walter White ?", answer: "Professeur de chimie" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quel super-héros est un homme-araignée ?", answer: "Spider-Man" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Dans quelle ville se déroule Friends ?", answer: "New York" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Qui joue Iron Man ?", answer: "Robert Downey Jr." },
            { category: "Cinéma & Séries", difficulty: "Difficile", question: "Quel film a gagné 11 Oscars (comme Titanic) ?", answer: "Ben-Hur" },
            { category: "Cinéma & Séries", difficulty: "Expert", question: "Quel est le nom du traîneau dans Citizen Kane ?", answer: "Rosebud" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Qui est le père de Luke Skywalker ?", answer: "Dark Vador" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Quel est le nom du poisson clown perdu ?", answer: "Nemo" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Quel agent secret a le matricule 007 ?", answer: "James Bond" },
            { category: "Cinéma & Séries", difficulty: "Difficile", question: "Qui a réalisé Inception ?", answer: "Christopher Nolan" },
            { category: "Cinéma & Séries", difficulty: "Expert", question: "En quelle année est sorti le premier Star Wars ?", answer: "1977" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quel est le nom du jouet cow-boy dans Toy Story ?", answer: "Woody" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Quelle famille habite à Springfield ?", answer: "Les Simpson" },
            { category: "Cinéma & Séries", difficulty: "Difficile", question: "Quel acteur joue Forrest Gump ?", answer: "Tom Hanks" },
            { category: "Cinéma & Séries", difficulty: "Expert", question: "Qui a réalisé 'Le Parrain' ?", answer: "Coppola" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Quel est le nom du chien de Mickey ?", answer: "Pluto" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quel super-héros est vert et fort ?", answer: "Hulk" },
            { category: "Cinéma & Séries", difficulty: "Difficile", question: "Dans quel film voit-on la planète Pandora ?", answer: "Avatar" },
            { category: "Cinéma & Séries", difficulty: "Expert", question: "Quel est le vrai nom de Marilyn Monroe ?", answer: "Norma Jeane Baker" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Qui est la Reine des Neiges ?", answer: "Elsa" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Qui est l'ami de Shrek ?", answer: "L'Âne" },
            { category: "Cinéma & Séries", difficulty: "Difficile", question: "Quel film a pour réplique 'I'll be back' ?", answer: "Terminator" },
            { category: "Cinéma & Séries", difficulty: "Expert", question: "Qui joue le Joker dans 'The Dark Knight' ?", answer: "Heath Ledger" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Qui est le frère de Thor ?", answer: "Loki" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quel est le nom de la fée dans Peter Pan ?", answer: "Clochette" },
            { category: "Cinéma & Séries", difficulty: "Difficile", question: "Dans quelle ville se passe 'Stranger Things' ?", answer: "Hawkins" },
            { category: "Cinéma & Séries", difficulty: "Expert", question: "Qui a réalisé 'La La Land' ?", answer: "Damien Chazelle" },
            { category: "Cinéma & Séries", difficulty: "Moyen", question: "Qui est le capitaine du Black Pearl ?", answer: "Jack Sparrow" },
            { category: "Cinéma & Séries", difficulty: "Facile", question: "Quel animal est Bambi ?", answer: "Un faon" },

            // --- MUSIQUE ---
            { category: "Musique", difficulty: "Facile", question: "Qui chante 'All I Want for Christmas Is You' ?", answer: "Mariah Carey" },
            { category: "Musique", difficulty: "Facile", question: "Qui est la Reine de la Pop ?", answer: "Madonna" },
            { category: "Musique", difficulty: "Facile", question: "Quel DJ porte un casque de guimauve ?", answer: "Marshmello" },
            { category: "Musique", difficulty: "Facile", question: "Qui chante 'Baby One More Time' ?", answer: "Britney Spears" },
            { category: "Musique", difficulty: "Facile", question: "Quel groupe a chanté 'We Will Rock You' ?", answer: "Queen" },
            { category: "Musique", difficulty: "Moyen", question: "Quel groupe a chanté 'Bohemian Rhapsody' ?", answer: "Queen" },
            { category: "Musique", difficulty: "Moyen", question: "Quel instrument a des cordes et un archet ?", answer: "Le violon" },
            { category: "Musique", difficulty: "Moyen", question: "Qui a chanté 'La Bohème' ?", answer: "Charles Aznavour" },
            { category: "Musique", difficulty: "Moyen", question: "Qui est le rappeur de 'Gangsta's Paradise' ?", answer: "Coolio" },
            { category: "Musique", difficulty: "Moyen", question: "De quelle ville viennent les Beatles ?", answer: "Liverpool" },
            { category: "Musique", difficulty: "Difficile", question: "Quel groupe français chante 'L'Aventurier' ?", answer: "Indochine" },
            { category: "Musique", difficulty: "Difficile", question: "Quel groupe de rock a un éclair sur le visage ?", answer: "David Bowie" },
            { category: "Musique", difficulty: "Difficile", question: "Combien de touches a un piano standard ?", answer: "88" },
            { category: "Musique", difficulty: "Expert", question: "Quel est l'opus de la 9ème symphonie de Beethoven ?", answer: "Opus 125" },
            { category: "Musique", difficulty: "Expert", question: "En quelle année est mort Kurt Cobain ?", answer: "1994" },
            { category: "Musique", difficulty: "Facile", question: "Quel instrument a 6 cordes ?", answer: "Guitare" },
            { category: "Musique", difficulty: "Facile", question: "Qui chante 'Thriller' ?", answer: "Michael Jackson" },
            { category: "Musique", difficulty: "Moyen", question: "Quel est le prénom de Mozart ?", answer: "Wolfgang" },
            { category: "Musique", difficulty: "Difficile", question: "Quel est le vrai nom de Lady Gaga ?", answer: "Stefani Germanotta" },
            { category: "Musique", difficulty: "Moyen", question: "Quel rappeur a épousé Beyoncé ?", answer: "Jay-Z" },
            { category: "Musique", difficulty: "Moyen", question: "Qui a chanté 'La Vie en Rose' ?", answer: "Édith Piaf" },
            { category: "Musique", difficulty: "Expert", question: "Qui a composé 'Les Quatre Saisons' ?", answer: "Vivaldi" },
            { category: "Musique", difficulty: "Facile", question: "Quel DJ porte un casque blanc ?", answer: "Marshmello" },
            { category: "Musique", difficulty: "Moyen", question: "Quel est le prénom de Johnny Hallyday ?", answer: "Jean-Philippe" },
            { category: "Musique", difficulty: "Difficile", question: "Quel groupe a chanté 'Highway to Hell' ?", answer: "AC/DC" },
            { category: "Musique", difficulty: "Expert", question: "Quel est le nom du dernier album des Beatles ?", answer: "Let It Be" },
            { category: "Musique", difficulty: "Facile", question: "Qui chante 'Happy' ?", answer: "Pharrell Williams" },
            { category: "Musique", difficulty: "Moyen", question: "Quel instrument joue Elton John ?", answer: "Piano" },
            { category: "Musique", difficulty: "Difficile", question: "Qui est le chanteur de U2 ?", answer: "Bono" },
            { category: "Musique", difficulty: "Expert", question: "Quel est le vrai nom de Sting ?", answer: "Gordon Sumner" },
            { category: "Musique", difficulty: "Facile", question: "Quel groupe chante 'We Will Rock You' ?", answer: "Queen" },
            { category: "Musique", difficulty: "Moyen", question: "Qui chante 'Rolling in the Deep' ?", answer: "Adele" },
            { category: "Musique", difficulty: "Difficile", question: "Qui a gagné l'Eurovision en 1974 ?", answer: "ABBA" },
            { category: "Musique", difficulty: "Expert", question: "Quel est le vrai nom de Eminem ?", answer: "Marshall Mathers" },
            { category: "Musique", difficulty: "Moyen", question: "Qui est le roi du Reggae ?", answer: "Bob Marley" },
            { category: "Musique", difficulty: "Facile", question: "Qui chante 'Djadja' ?", answer: "Aya Nakamura" },
            { category: "Musique", difficulty: "Difficile", question: "Quel groupe porte des casques de robots ?", answer: "Daft Punk" },
            { category: "Musique", difficulty: "Expert", question: "En quelle année est mort Elvis Presley ?", answer: "1977" },
            { category: "Musique", difficulty: "Moyen", question: "Quel est l'instrument de Louis Armstrong ?", answer: "Trompette" },
            { category: "Musique", difficulty: "Facile", question: "Combien de membres dans les Beatles ?", answer: "4" },
            { category: "Musique", difficulty: "Difficile", question: "Qui a écrit 'La Marseillaise' ?", answer: "Rouget de Lisle" },
            { category: "Musique", difficulty: "Expert", question: "Quel est le premier album de Michael Jackson ?", answer: "Got to Be There" },
            { category: "Musique", difficulty: "Moyen", question: "Qui chante 'Papaoutai' ?", answer: "Stromae" },
            { category: "Musique", difficulty: "Facile", question: "Quel instrument a des touches noires et blanches ?", answer: "Piano" },
            { category: "Musique", difficulty: "Difficile", question: "Qui est le batteur des Beatles ?", answer: "Ringo Starr" },

             // --- JEUX VIDÉO ---
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Quel est le prénom de Mario ?", answer: "Mario" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Dans quel jeu construit-on avec des blocs cubiques ?", answer: "Minecraft" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Dans quel jeu tire-t-on sur des oiseaux avec une fronde ?", answer: "Angry Birds" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Dans quel jeu y a-t-il des imposteurs ?", answer: "Among Us" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Dans quel jeu explore-t-on Hyrule ?", answer: "Zelda" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Quelle est la couleur de Pac-Man ?", answer: "Jaune" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Dans quel jeu attrape-t-on des monstres ?", answer: "Pokémon" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Quel hérisson est bleu et rapide ?", answer: "Sonic" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Quelle console a été créée par Sony ?", answer: "PlayStation" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Quel est le frère de Mario ?", answer: "Luigi" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Quel jeu de foot est le concurrent de PES ?", answer: "FIFA (ou EA FC)" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Quelle est la couleur de la casquette de Luigi ?", answer: "Verte" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Qui est l'ennemi de Sonic ?", answer: "Dr. Robotnik (Eggman)" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Quel héros est un bandicoot ?", answer: "Crash Bandicoot" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Quel est le jeu de cartes de l'univers Warcraft ?", answer: "Hearthstone" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "En quelle année est sortie la première PlayStation au Japon ?", answer: "1994" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "Comment s'appelle le créateur de Mario ?", answer: "Shigeru Miyamoto" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Quel jeu consiste à empiler des briques ?", answer: "Tetris" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Quel est le nom de la princesse dans Mario ?", answer: "Peach" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Dans quel jeu incarne-t-on Kratos ?", answer: "God of War" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "En quelle année est sorti World of Warcraft ?", answer: "2004" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Quelle console a suivi la PS3 ?", answer: "PS4" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Quel est le nom du dragon violet ?", answer: "Spyro" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "Qui a créé Mario ?", answer: "Shigeru Miyamoto" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Quel est l'animal Sonic ?", answer: "Hérisson" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Quel gorille lance des tonneaux ?", answer: "Donkey Kong" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Quel est le nom du soldat vert dans Halo ?", answer: "Master Chief" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "Quel est le jeu le plus vendu de tous les temps ?", answer: "Minecraft" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Qui est l'héroïne de Tomb Raider ?", answer: "Lara Croft" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Quel studio a créé GTA ?", answer: "Rockstar Games" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "Quel est le nom du héros de Final Fantasy 7 ?", answer: "Cloud Strife" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Dans quel jeu gère-t-on une ville ?", answer: "SimCity" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Quelle console a une manette blanche et une télécommande ?", answer: "Wii" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Qui est le frère de Solid Snake ?", answer: "Liquid Snake" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "Quel est le premier jeu vidéo commercial ?", answer: "Pong" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Quel jeu de voiture a des carapaces bleues ?", answer: "Mario Kart" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Quel est le nom de l'assassin dans Assassin's Creed 1 ?", answer: "Altaïr" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "Combien de Pokémon y avait-il dans la 1ère génération ?", answer: "151" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Dans quel jeu combat-on dans une arène ?", answer: "Super Smash Bros" },
            { category: "Jeux Vidéo", difficulty: "Facile", question: "Quelle est la couleur de la casquette de Mario ?", answer: "Rouge" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Quel est le nom de la ville dans Resident Evil ?", answer: "Raccoon City" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "En quelle année est sorti la Nintendo 64 ?", answer: "1996" },
            { category: "Jeux Vidéo", difficulty: "Moyen", question: "Qui est le méchant dans Zelda ?", answer: "Ganon" },
            { category: "Jeux Vidéo", difficulty: "Difficile", question: "Quel jeu se passe à Rapture ?", answer: "BioShock" },
            { category: "Jeux Vidéo", difficulty: "Expert", question: "Quel est le code de triche le plus célèbre ?", answer: "Konami Code" },

            // --- SCIENCES ---
            { category: "Sciences & Nature", difficulty: "Facile", question: "Quel est le symbole chimique de l'eau ?", answer: "H2O" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "Quel gaz est nécessaire pour respirer ?", answer: "Oxygène" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "À combien de degrés l'eau gèle-t-elle ?", answer: "0" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "Quel organe permet de penser ?", answer: "Le cerveau" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Quelle planète est la plus proche du soleil ?", answer: "Mercure" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Quel est le plus grand mammifère ?", answer: "La baleine bleue" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Quelle planète a des anneaux ?", answer: "Saturne" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Combien d'os dans le corps humain (adulte) ?", answer: "206" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Quel est l'animal le plus rapide du monde (oiseau) ?", answer: "Le faucon pèlerin" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Quel est le nom de la théorie de Darwin ?", answer: "L'évolution" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Quel est l'élément chimique le plus léger ?", answer: "L'Hydrogène" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "Combien de pattes a une araignée ?", answer: "8" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "Quel gaz respire-t-on ?", answer: "Oxygène" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Qui a inventé l'ampoule ?", answer: "Edison" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Combien de dents a un adulte ?", answer: "32" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Quelle est la vitesse de la lumière ?", answer: "300 000 km/s" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Combien de chromosomes a l'humain ?", answer: "46" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "A combien de degrés bout l'eau ?", answer: "100" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Quel organe pompe le sang ?", answer: "Coeur" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Quel est le gaz le plus abondant dans l'air ?", answer: "Azote" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Qui a formulé la relativité ?", answer: "Einstein" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "Quel animal a un long cou ?", answer: "Girafe" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Quelle force nous attire au sol ?", answer: "Gravité" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Quel est l'organe le plus grand ?", answer: "Peau" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Nom de la première brebis clonée ?", answer: "Dolly" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "Combien de planètes dans le système solaire ?", answer: "8" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Quel est le symbole chimique de l'Or ?", answer: "Au" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Qui a découvert la pénicilline ?", answer: "Fleming" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Quelle est la distance Terre-Soleil ?", answer: "150 millions km" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "De quelle couleur est le sang ?", answer: "Rouge" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Quel est l'animal terrestre le plus rapide ?", answer: "Guépard" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Combien de coeurs a une pieuvre ?", answer: "3" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Quel est l'os le plus long du corps ?", answer: "Fémur" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "Quel astre nous éclaire le jour ?", answer: "Soleil" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Quelle planète est rouge ?", answer: "Mars" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Qui a découvert le radium ?", answer: "Marie Curie" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Quelle particule a une charge négative ?", answer: "Electron" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Quel arbre produit des glands ?", answer: "Chêne" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "Quel liquide sort d'un volcan ?", answer: "Lave" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Quelle est l'unité de mesure du son ?", answer: "Décibel" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Quel est le pH de l'eau pure ?", answer: "7" },
            { category: "Sciences & Nature", difficulty: "Moyen", question: "Combien de pattes a une mouche ?", answer: "6" },
            { category: "Sciences & Nature", difficulty: "Facile", question: "Quel oiseau ne vole pas et vit sur la glace ?", answer: "Manchot" },
            { category: "Sciences & Nature", difficulty: "Difficile", question: "Quel est le plus grand océan ?", answer: "Pacifique" },
            { category: "Sciences & Nature", difficulty: "Expert", question: "Qui a inventé la dynamite ?", answer: "Alfred Nobel" },

            // --- LITTÉRATURE ---
            { category: "Littérature & BD", difficulty: "Facile", question: "Qui a écrit Harry Potter ?", answer: "J.K. Rowling" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Quel héros de BD est reporter ?", answer: "Tintin" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Quel est le nom du chien d'Obélix ?", answer: "Idéfix" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui a écrit Les Misérables ?", answer: "Victor Hugo" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui a écrit Les Trois Mousquetaires ?", answer: "Alexandre Dumas" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Quel poète a écrit 'Les Fleurs du Mal' ?", answer: "Baudelaire" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Quel est le vrai nom de Molière ?", answer: "Jean-Baptiste Poquelin" },
            { category: "Littérature & BD", difficulty: "Expert", question: "Qui a écrit 'À la recherche du temps perdu' ?", answer: "Marcel Proust" },
            { category: "Littérature & BD", difficulty: "Expert", question: "Quel est le livre le plus vendu au monde (hors Bible) ?", answer: "Don Quichotte" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Qui est l'amoureux de Juliette ?", answer: "Roméo" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Quel cowboy tire plus vite que son ombre ?", answer: "Lucky Luke" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui a écrit les Fables ?", answer: "La Fontaine" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui est le créateur de Tintin ?", answer: "Hergé" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Qui a écrit 'L'Avare' ?", answer: "Molière" },
            { category: "Littérature & BD", difficulty: "Expert", question: "Quel auteur a refusé le prix Nobel ?", answer: "Sartre" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Quel personnage a un long nez quand il ment ?", answer: "Pinocchio" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui est l'ami de Sherlock Holmes ?", answer: "Watson" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui a écrit 'Vingt mille lieues sous les mers' ?", answer: "Jules Verne" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Qui a écrit '1984' ?", answer: "Orwell" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Quel gaulois est tombé dans la marmite ?", answer: "Obélix" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Quel est le nom du capitaine dans Tintin ?", answer: "Haddock" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Qui a écrit 'Madame Bovary' ?", answer: "Flaubert" },
            { category: "Littérature & BD", difficulty: "Expert", question: "Qui a écrit 'La Divine Comédie' ?", answer: "Dante" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Quel petit garçon ne veut pas grandir ?", answer: "Peter Pan" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui a écrit Le Petit Prince ?", answer: "Saint-Exupéry" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Qui est l'auteur de 'Germinal' ?", answer: "Zola" },
            { category: "Littérature & BD", difficulty: "Expert", question: "Quel est le prénom de Rimbaud ?", answer: "Arthur" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Quel héros porte une cape rouge et un S ?", answer: "Superman" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui est le valet de Don Quichotte ?", answer: "Sancho Panza" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Qui a écrit 'Orgueil et Préjugés' ?", answer: "Jane Austen" },
            { category: "Littérature & BD", difficulty: "Expert", question: "Qui a écrit 'Ulysse' ?", answer: "James Joyce" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui est le créateur d'Astérix ?", answer: "Goscinny et Uderzo" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Quel animal est le Chat Botté ?", answer: "Un chat" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Qui a écrit 'Le Rouge et le Noir' ?", answer: "Stendhal" },
            { category: "Littérature & BD", difficulty: "Expert", question: "Quel poète a écrit 'Alcools' ?", answer: "Apollinaire" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Quel détective belge a été créé par Agatha Christie ?", answer: "Hercule Poirot" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Qui veut tuer Blanche-Neige ?", answer: "La Reine" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Qui a écrit 'L'Étranger' ?", answer: "Camus" },
            { category: "Littérature & BD", difficulty: "Expert", question: "Dans quelle ville se passe 'Ulysse' de Joyce ?", answer: "Dublin" },
            { category: "Littérature & BD", difficulty: "Moyen", question: "Qui est le fiancé de la Castafiore (rumeur) ?", answer: "Haddock" },
            { category: "Littérature & BD", difficulty: "Facile", question: "Quel super-héros est riche et s'habille en chauve-souris ?", answer: "Batman" },
            { category: "Littérature & BD", difficulty: "Difficile", question: "Qui a écrit 'Les Hauts de Hurlevent' ?", answer: "Emily Brontë" },
            { category: "Littérature & BD", difficulty: "Expert", question: "Qui a écrit 'Voyage au bout de la nuit' ?", answer: "Céline" },
        ];

        // --- ICONS (SVG) ---
        // (Les mêmes icônes que précédemment)
        const Icons = {
            Trophy: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
            Settings: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
            Play: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>,
            Pause: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>,
            RotateCcw: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>,
            XCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>,
            CheckCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            Plus: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
            Trash: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>,
            History: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v5h5"/><path d="M3.05 13A9 9 0 1 0 6 5.3L3 8"/><path d="M12 7v5l4 2"/></svg>,
            Skip: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 4 15 12 5 20 5 4"/><line x1="19" y1="5" x2="19" y2="19"/></svg>,
            Shield: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
            Maximize: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>,
            Zap: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
            Volume2: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>,
            VolumeX: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>,
            Joker: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9 13s1.5 2 3 2 3-2 3-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/><path d="M12 2a5 5 0 0 1 5 5v2h-2V7a3 3 0 0 0-6 0v2H7V7a5 5 0 0 1 5-5z"/></svg>,
            Skull: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 2c-3.3 0-6 2.7-6 6v3c0 2.3 2.1 4.3 4.2 5.5l.3.2a10 10 0 0 0 3 0l.3-.2C15.9 15.3 18 13.3 18 11V8c0-3.3-2.7-6-6-6Z"/><path d="M10 18h4"/><path d="M9 22h6"/><circle cx="9" cy="9" r="1"/><circle cx="15" cy="9" r="1"/></svg>,
            Upload: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>,
            Image: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>,
            Save: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>,
            Music: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>,
            Undo: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 14 4 9l5-5"/><path d="M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11"/></svg>,
            Download: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>,
            FileUp: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M12 12v6"/><path d="m15 15-3-3-3 3"/></svg>
        };

        // --- AUDIO ENGINE ---
        const playSound = (type = 'CORRECT') => {
            try {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                if (!AudioContext) return;
                const ctx = new AudioContext();
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                const sound = SOUNDS[type];
                osc.type = sound.type;
                osc.frequency.setValueAtTime(sound.freq, ctx.currentTime);
                gain.gain.setValueAtTime(0, ctx.currentTime);
                gain.gain.linearRampToValueAtTime(0.1, ctx.currentTime + 0.01);
                gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + sound.duration);
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.start();
                osc.stop(ctx.currentTime + sound.duration);
            } catch (e) {}
        };

        const App = () => {
            // --- ETATS ---
            const [settings, setSettings] = useState({
                initialTime: 60,
                suddenDeath: false,
                soundEnabled: true,
                musicEnabled: false
            });

            const [gameState, setGameState] = useState('setup');
            const [players, setPlayers] = useState([
                { id: 1, name: 'Joueur 1', time: 60, status: 'alive', jokers: 1, avatar: '' },
                { id: 2, name: 'Joueur 2', time: 60, status: 'alive', jokers: 1, avatar: '' }
            ]);
            const [categories, setCategories] = useState(INITIAL_CATEGORIES);
            const [customQuestions, setCustomQuestions] = useState([]);
            const [allQuestions, setAllQuestions] = useState([...BASE_QUESTIONS]); 

            const [activePlayerIndex, setActivePlayerIndex] = useState(0);
            const [currentQ, setCurrentQ] = useState(null);
            const [winner, setWinner] = useState(null);
            const [isTimerRunning, setIsTimerRunning] = useState(false);
            const [selectedCategory, setSelectedCategory] = useState("TOUT MÉLANGER");

            const [showHistory, setShowHistory] = useState(false);
            const [showImport, setShowImport] = useState(false);
            const [history, setHistory] = useState([]);
            const [isAdminMode, setIsAdminMode] = useState(false);
            const [penaltyAnim, setPenaltyAnim] = useState(null);
            const [isFullscreen, setIsFullscreen] = useState(false);
            const [prevState, setPrevState] = useState(null);

            const timerRef = useRef(null);
            const musicRef = useRef(null); 
            const saveTimeoutRef = useRef(null);
            const fileInputRef = useRef(null);

            // --- GENERATEUR DE QUESTIONS ---
            const generateQuestions = useCallback(() => {
                let generated = [...BASE_QUESTIONS];

                // Géographie
                DATA_SETS.COUNTRIES.forEach(([country, capital, diff]) => {
                    generated.push({ category: "Géographie", difficulty: diff, question: `Quelle est la capitale de : ${country} ?`, answer: capital });
                    if (diff === 'Facile' || diff === 'Moyen') {
                        generated.push({ category: "Géographie", difficulty: diff === 'Facile' ? 'Moyen' : 'Difficile', question: `${capital} est la capitale de quel pays ?`, answer: country });
                    }
                });

                // Sciences (Éléments)
                DATA_SETS.ELEMENTS.forEach(([symbol, name, diff]) => {
                    generated.push({ category: "Sciences & Nature", difficulty: diff, question: `Quel est le symbole chimique de : ${name} ?`, answer: symbol });
                });
                
                // Littérature
                DATA_SETS.AUTHORS.forEach(([book, author, diff]) => {
                    generated.push({ category: "Littérature & BD", difficulty: diff, question: `Qui a écrit "${book}" ?`, answer: author });
                });

                return generated;
            }, []);

            // Initial Load
            useEffect(() => {
                const gen = generateQuestions();
                setAllQuestions([...gen, ...customQuestions]);
            }, [customQuestions, generateQuestions]);

            // --- AUTO SAVE ---
            useEffect(() => {
                const savedData = localStorage.getItem('coup_fatal_save_v2');
                if (savedData) {
                    try {
                        const parsed = JSON.parse(savedData);
                        if (confirm("Une partie sauvegardée a été trouvée. Reprendre ?")) {
                            setSettings(parsed.settings || settings);
                            setPlayers(parsed.players || players);
                            setCustomQuestions(parsed.customQuestions || []);
                            // Pas besoin de save allQuestions, on regenère
                            if (parsed.gameState === 'playing') {
                                setGameState('playing');
                                setCurrentQ(parsed.currentQ);
                                setActivePlayerIndex(parsed.activePlayerIndex || 0);
                                setHistory(parsed.history || []);
                            }
                        }
                    } catch (e) { console.error(e); }
                }
            }, []);

            useEffect(() => {
                if (saveTimeoutRef.current) clearTimeout(saveTimeoutRef.current);
                saveTimeoutRef.current = setTimeout(() => {
                    const dataToSave = {
                        settings, players, customQuestions, gameState, currentQ, activePlayerIndex, history
                    };
                    localStorage.setItem('coup_fatal_save_v2', JSON.stringify(dataToSave));
                }, 1000);
            }, [settings, players, customQuestions, gameState, currentQ, activePlayerIndex, history]);

            // --- MUSIQUE ---
            useEffect(() => {
                if (!settings.musicEnabled || gameState !== 'playing' || !isTimerRunning) {
                    if (musicRef.current) { clearInterval(musicRef.current); musicRef.current = null; }
                    return;
                }
                const currentPlayer = players[activePlayerIndex];
                let interval = 1000; 
                if (settings.suddenDeath && currentPlayer.time < 5) interval = 250; 
                else if (currentPlayer.time < 10) interval = 500; 
                if (musicRef.current) clearInterval(musicRef.current);
                musicRef.current = setInterval(() => {
                    playSound(interval === 1000 ? 'BEAT_LOW' : 'BEAT_HIGH');
                }, interval);
                return () => clearInterval(musicRef.current);
            }, [isTimerRunning, activePlayerIndex, players, settings.musicEnabled, settings.suddenDeath]);

            // --- TIMER ---
            useEffect(() => {
                if (gameState === 'playing' && isTimerRunning) {
                    timerRef.current = setInterval(() => {
                        setPlayers(prevPlayers => {
                            const newPlayers = [...prevPlayers];
                            const currentPlayer = newPlayers[activePlayerIndex];
                            if (currentPlayer.time <= 0.1) {
                                currentPlayer.time = 0;
                                currentPlayer.status = 'eliminated';
                                handlePlayerEliminated(newPlayers);
                                return newPlayers;
                            }
                            currentPlayer.time -= 0.1;
                            return newPlayers;
                        });
                    }, 100);
                } else {
                    clearInterval(timerRef.current);
                }
                return () => clearInterval(timerRef.current);
            }, [gameState, isTimerRunning, activePlayerIndex]);

            // --- CLAVIER ---
            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (gameState !== 'playing') return;
                    if (e.code === 'Space') { e.preventDefault(); toggleTimer(); }
                    if (e.code === 'ArrowRight') handleCorrect();
                    if (e.code === 'ArrowLeft') handleWrong();
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [gameState, isTimerRunning, activePlayerIndex, currentQ, players]);

            // --- ACTIONS ---
            const addPlayer = () => {
                const newId = players.length > 0 ? Math.max(...players.map(p => p.id)) + 1 : 1;
                setPlayers([...players, { id: newId, name: `Joueur ${players.length + 1}`, time: settings.initialTime, status: 'alive', jokers: 1, avatar: '' }]);
            };

            const removePlayer = (id) => {
                if (players.length > 2) setPlayers(players.filter(p => p.id !== id));
            };

            const updatePlayerName = (id, newName) => setPlayers(players.map(p => p.id === id ? { ...p, name: newName } : p));

            const toggleFullscreen = () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen();
                    setIsFullscreen(true);
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                        setIsFullscreen(false);
                    }
                }
            };

            const adjustTime = (playerId, amount) => {
                setPlayers(players.map(p => {
                    if (p.id === playerId) {
                        return { ...p, time: Math.max(0, p.time + amount) };
                    }
                    return p;
                }));
            };

            const resetPlayerTime = (playerId) => {
                setPlayers(players.map(p => {
                    if (p.id === playerId) return { ...p, time: settings.initialTime, status: 'alive', jokers: 1 };
                    return p;
                }));
            };

            const saveStateForUndo = () => {
                setPrevState({
                    players: JSON.parse(JSON.stringify(players)),
                    activePlayerIndex,
                    currentQ,
                    history: [...history],
                    isTimerRunning
                });
            };

            const handleUndo = () => {
                if (!prevState) return;
                if (settings.soundEnabled) playSound('UNDO');
                setPlayers(prevState.players);
                setActivePlayerIndex(prevState.activePlayerIndex);
                setCurrentQ(prevState.currentQ);
                setHistory(prevState.history);
                setIsTimerRunning(false); 
                setPrevState(null);
            };

            const handlePlayerEliminated = (currentPlayersState) => {
                setIsTimerRunning(false);
                if (settings.soundEnabled) playSound('END');
                const survivors = currentPlayersState.filter(p => p.status === 'alive');
                if (survivors.length === 1) {
                    setWinner(survivors[0].name);
                    setGameState('ended');
                } else {
                    let nextIndex = activePlayerIndex;
                    let loop = 0;
                    do { nextIndex = (nextIndex + 1) % currentPlayersState.length; loop++; }
                    while (currentPlayersState[nextIndex].status !== 'alive' && loop < currentPlayersState.length);
                    setActivePlayerIndex(nextIndex);
                }
            };

            // --- SYSTÈME DE COOLDOWN ET FILTRAGE ---
            const getUsedQuestionsLog = () => {
                const log = localStorage.getItem(HISTORY_STORAGE_KEY);
                return log ? JSON.parse(log) : [];
            };

            const saveUsedQuestionsLog = (log) => {
                localStorage.setItem(HISTORY_STORAGE_KEY, JSON.stringify(log));
            };

            const markQuestionAsUsed = (question) => {
                const log = getUsedQuestionsLog();
                const newLog = [...log, question.question]; 
                if (newLog.length > MAX_HISTORY_SIZE) {
                    newLog.splice(0, newLog.length - MAX_HISTORY_SIZE);
                }
                saveUsedQuestionsLog(newLog);
            };

            // ALGORITHME DE DIFFICULTÉ DYNAMIQUE + FILTRAGE
            const getWeightedQuestion = () => {
                const currentPlayer = players[activePlayerIndex];
                const ratio = currentPlayer.time / settings.initialTime;
                
                let weights = { Facile: 0.25, Moyen: 0.5, Difficile: 0.2, Expert: 0.05 }; 

                if (ratio > 0.66) { // Early Game
                    weights = { Facile: 0.45, Moyen: 0.45, Difficile: 0.05, Expert: 0.05 };
                } else if (ratio < 0.33) { // Late Game
                    weights = { Facile: 0.05, Moyen: 0.20, Difficile: 0.55, Expert: 0.20 };
                } else { // Mid Game
                    weights = { Facile: 0.20, Moyen: 0.40, Difficile: 0.30, Expert: 0.10 };
                }

                // 1. Filtrer par catégorie
                let pool = [];
                if (selectedCategory === "TOUT MÉLANGER") pool = [...allQuestions];
                else pool = allQuestions.filter(q => q.category === selectedCategory);

                // 2. Filtrer les questions déjà posées (Cooldown)
                const usedLog = getUsedQuestionsLog();
                const freshPool = pool.filter(q => !usedLog.includes(q.question));

                const finalPool = freshPool.length > 0 ? freshPool : pool;

                if (finalPool.length === 0) return { question: "Erreur: Pas de questions", answer: "...", difficulty: "N/A" };

                // 3. Sélection par difficulté
                const rand = Math.random();
                let selectedDiff = "Moyen";
                if (rand < weights.Facile) selectedDiff = "Facile";
                else if (rand < weights.Facile + weights.Moyen) selectedDiff = "Moyen";
                else if (rand < weights.Facile + weights.Moyen + weights.Difficile) selectedDiff = "Difficile";
                else selectedDiff = "Expert";

                // Filter by difficulty
                let diffPool = finalPool.filter(q => q.difficulty === selectedDiff);
                if (diffPool.length === 0) diffPool = finalPool; // Fallback

                // Pick random question
                const picked = diffPool[Math.floor(Math.random() * diffPool.length)];
                return picked;
            };

            const handleCorrect = () => {
                saveStateForUndo();
                if (settings.soundEnabled) playSound('CORRECT');
                setIsTimerRunning(false); 

                if (currentQ) markQuestionAsUsed(currentQ);

                setPlayers(prev => prev.map((p, i) => {
                    if (i === activePlayerIndex) {
                        if (settings.suddenDeath && p.time < 5) return p;
                        if (p.time > 0 && p.time < 5) return { ...p, time: 5 };
                    }
                    return p;
                }));
                nextTurn();
            };

            const handleWrong = () => {
                saveStateForUndo();
                if (settings.soundEnabled) playSound('WRONG');
                const currentPlayer = players[activePlayerIndex];
                
                if (settings.suddenDeath && currentPlayer.time < 5) {
                    const newPlayers = players.map((p, i) => i === activePlayerIndex ? { ...p, time: 0, status: 'eliminated' } : p);
                    setPlayers(newPlayers);
                    handlePlayerEliminated(newPlayers);
                    return;
                }

                if (currentQ) markQuestionAsUsed(currentQ);

                addToHistory('wrong');
                setCurrentQ(getWeightedQuestion());
            };

            const handleSkip = () => {
                if (currentQ) markQuestionAsUsed(currentQ);
                addToHistory('wrong', true);
                setCurrentQ(getWeightedQuestion());
            };

            const nextTurn = () => {
                let nextIndex = activePlayerIndex;
                let loop = 0;
                do { nextIndex = (nextIndex + 1) % players.length; loop++; }
                while (players[nextIndex].status !== 'alive' && loop < players.length);
                setActivePlayerIndex(nextIndex);
                setCurrentQ(getWeightedQuestion());
            };

            const startGame = () => {
                const resetPlayers = players.map(p => ({ ...p, time: settings.initialTime, status: 'alive', jokers: 1 }));
                setPlayers(resetPlayers);
                setActivePlayerIndex(0);
                setGameState('playing');
                setWinner(null);
                setIsTimerRunning(false);
                setPrevState(null);
                setHistory([]);
                setTimeout(() => setCurrentQ(getWeightedQuestion()), 10);
            };

            const restartGameSamePlayers = () => {
                setHistory([]); 
                const resetPlayers = players.map(p => ({ ...p, time: settings.initialTime, status: 'alive', jokers: 1 }));
                setPlayers(resetPlayers);
                setActivePlayerIndex(0); 
                setWinner(null);
                setIsTimerRunning(false);
                setGameState('playing');
                setPrevState(null);
                setTimeout(() => setCurrentQ(getWeightedQuestion()), 0);
            };

            const toggleTimer = () => setIsTimerRunning(!isTimerRunning);

            const addToHistory = (status, skipped = false) => {
                if (!currentQ) return;
                const currentPlayer = players[activePlayerIndex];
                setHistory(prev => [{
                    question: currentQ.question, answer: currentQ.answer, playerName: currentPlayer.name, status: skipped ? 'passé' : status, timestamp: new Date().toLocaleTimeString()
                }, ...prev]);
            };

            // --- FILE MANAGEMENT ---
            const exportData = () => {
                const dataStr = JSON.stringify(customQuestions, null, 2);
                const blob = new Blob([dataStr], {type: "application/json"});
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.download = "coup_fatal_questions.json";
                link.href = url;
                link.click();
            };

            const importData = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const json = JSON.parse(e.target.result);
                        if (Array.isArray(json)) {
                            setCustomQuestions(prev => [...prev, ...json]);
                            alert(`${json.length} questions importées avec succès !`);
                        } else {
                            alert("Format invalide. Doit être un tableau JSON.");
                        }
                    } catch (err) { alert("Erreur de lecture du fichier."); }
                };
                reader.readAsText(file);
            };

            // --- IMPORT MENU ---
            const ImportMenu = () => {
                const [newQ, setNewQ] = useState({ category: "", difficulty: "Moyen", question: "", answer: "" });
                const addQuestion = () => {
                    if (!newQ.category || !newQ.question || !newQ.answer) return alert("Remplissez tout !");
                    setCustomQuestions(prev => [...prev, newQ]);
                    setNewQ({ ...newQ, question: "", answer: "" });
                };

                return (
                    <div className="fixed inset-0 bg-slate-900/95 z-50 flex items-center justify-center p-4">
                        <div className="bg-slate-800 w-full max-w-4xl h-[90vh] rounded-2xl flex flex-col border border-slate-600 shadow-2xl">
                            <div className="p-6 border-b border-slate-700 flex justify-between">
                                <h2 className="text-2xl font-bold text-yellow-400 flex items-center gap-2"><Icons.Upload/> Centre d'Import & Base de Données</h2>
                                <button onClick={() => setShowImport(false)}><Icons.XCircle className="text-slate-400 hover:text-white"/></button>
                            </div>
                            <div className="flex-1 flex overflow-hidden">
                                <div className="w-1/2 p-6 overflow-y-auto border-r border-slate-700 space-y-4">
                                    <h3 className="font-bold text-lg mb-4 text-blue-300">Ajouter Manuellement</h3>
                                    <select className="w-full bg-slate-900 p-2 rounded border border-slate-600 mb-2" value={newQ.category} onChange={e => setNewQ({...newQ, category: e.target.value})}>
                                        <option value="">Catégorie...</option>
                                        {Object.values(INITIAL_CATEGORIES).map(c => <option key={c} value={c}>{c}</option>)}
                                    </select>
                                    <select className="w-full bg-slate-900 p-2 rounded border border-slate-600 mb-2" value={newQ.difficulty} onChange={e => setNewQ({...newQ, difficulty: e.target.value})}>
                                        <option>Facile</option><option>Moyen</option><option>Difficile</option><option>Expert</option>
                                    </select>
                                    <input className="w-full bg-slate-900 p-2 rounded border border-slate-600 mb-2" placeholder="Question" value={newQ.question} onChange={e => setNewQ({...newQ, question: e.target.value})} />
                                    <input className="w-full bg-slate-900 p-2 rounded border border-slate-600 mb-4" placeholder="Réponse" value={newQ.answer} onChange={e => setNewQ({...newQ, answer: e.target.value})} />
                                    <button onClick={addQuestion} className="w-full bg-green-600 py-2 rounded font-bold hover:bg-green-500">Ajouter</button>

                                    <div className="mt-8 border-t border-slate-700 pt-4">
                                        <h3 className="font-bold text-lg mb-4 text-purple-300">Gestion de Fichier JSON</h3>
                                        <div className="flex gap-2 mb-2">
                                            <button onClick={() => fileInputRef.current.click()} className="flex-1 bg-slate-700 py-2 rounded hover:bg-slate-600 flex items-center justify-center gap-2"><Icons.FileUp className="w-4 h-4"/> Charger un fichier</button>
                                            <input type="file" ref={fileInputRef} className="hidden" accept=".json" onChange={importData} />
                                            <button onClick={exportData} className="flex-1 bg-slate-700 py-2 rounded hover:bg-slate-600 flex items-center justify-center gap-2"><Icons.Download className="w-4 h-4"/> Sauvegarder</button>
                                        </div>
                                        <p className="text-xs text-slate-500">Format: Tableau d'objets `&#123;category, difficulty, question, answer&#125;`</p>
                                    </div>
                                </div>
                                <div className="w-1/2 p-6 overflow-y-auto bg-slate-900/50">
                                    <h3 className="font-bold text-lg mb-2">Total Questions : {allQuestions.length}</h3>
                                    <p className="text-xs text-slate-400 mb-4">Dont {customQuestions.length} personnalisées</p>
                                    <div className="space-y-2">
                                        {customQuestions.map((q, i) => (
                                            <div key={i} className="bg-slate-800 p-3 rounded border border-slate-700 text-sm relative group">
                                                <span className="text-xs text-blue-400 font-bold uppercase">{q.category}</span>
                                                <p className="font-semibold">{q.question}</p>
                                                <p className="text-green-400">{q.answer}</p>
                                                <button onClick={() => setCustomQuestions(customQuestions.filter((_, idx) => idx !== i))} className="absolute top-2 right-2 text-red-500 opacity-0 group-hover:opacity-100"><Icons.Trash className="w-4 h-4"/></button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            const formatTime = (seconds) => {
                const s = Math.max(0, Math.floor(seconds));
                const ms = Math.floor((Math.max(0, seconds) - s) * 10);
                return <span>{s < 10 ? `0${s}` : s}<span className="text-sm">.{ms}</span></span>;
            };

            const getGridClass = () => {
                const count = players.length;
                if (count <= 2) return "grid-cols-2";
                if (count <= 4) return "grid-cols-2 md:grid-cols-4";
                return "grid-cols-3";
            };

            const renderHistoryModal = () => (
                <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
                    <div className="bg-slate-900 w-full max-w-2xl rounded-2xl max-h-[80vh] flex flex-col border border-slate-700 shadow-2xl">
                        <div className="p-4 border-b border-slate-700 flex justify-between items-center">
                            <h2 className="text-xl font-bold text-yellow-400 flex items-center gap-2"><Icons.History className="w-6 h-6"/> Historique</h2>
                            <button onClick={() => setShowHistory(false)} className="text-slate-400 hover:text-white"><Icons.XCircle className="w-6 h-6"/></button>
                        </div>
                        <div className="overflow-y-auto p-4 space-y-3">
                            {history.length === 0 ? <p className="text-center text-slate-500">Aucune question posée.</p> : 
                            history.map((entry, i) => (
                                <div key={i} className={`p-3 rounded border border-slate-700 flex justify-between items-start ${entry.status === 'correct' ? 'bg-green-900/20' : 'bg-red-900/20'}`}>
                                    <div>
                                        <div className="flex gap-2 mb-1">
                                            <span className="font-bold text-sm text-yellow-200">{entry.playerName}</span>
                                            <span className="text-xs text-slate-500">({entry.timestamp})</span>
                                        </div>
                                        <p className="font-semibold text-white">{entry.question}</p>
                                        <p className="text-sm text-slate-400">Rép: {entry.answer}</p>
                                    </div>
                                    <span className={`text-xs font-bold px-2 py-1 rounded uppercase ${entry.status === 'correct' ? 'bg-green-600' : 'bg-red-600'}`}>{entry.status}</span>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );

            // --- RENDER ---
            const qToRender = currentQ || { category: "...", question: "Prêt ?", answer: "...", difficulty: "Moyen" };
            const isSuddenDeathActive = settings.suddenDeath && gameState === 'playing';

            return (
                <div className={`min-h-screen flex flex-col ${isSuddenDeathActive && players[activePlayerIndex]?.time < 5 ? 'sudden-death-bg' : ''} transition-colors duration-1000`}>
                    {showImport && <ImportMenu />}
                    {showHistory && renderHistoryModal()}
                    
                    {gameState === 'setup' && (
                        <div className="flex-1 flex flex-col items-center justify-center p-4 space-y-6">
                            <h1 className="text-5xl font-black text-yellow-400 neon-text text-center mb-4">LE DUEL <span className="text-sm block text-blue-300 font-normal mt-2">Encyclopédie Stable</span></h1>
                            <div className="flex flex-col md:flex-row gap-6 w-full max-w-6xl h-[70vh]">
                                <div className="card-glass flex-1 p-6 rounded-2xl flex flex-col border-t-4 border-blue-500">
                                    <div className="flex justify-between mb-4">
                                        <h3 className="font-bold text-xl">Joueurs</h3>
                                        <button onClick={addPlayer} className="bg-blue-600 p-1 rounded hover:bg-blue-500"><Icons.Plus className="w-5 h-5"/></button>
                                    </div>
                                    <div className="flex-1 overflow-y-auto space-y-4">
                                        {players.map(p => (
                                            <div key={p.id} className="bg-slate-800 p-3 rounded flex flex-col gap-2">
                                                <div className="flex gap-2 items-center">
                                                    <span className="font-bold w-6">{p.id}.</span>
                                                    <input className="flex-1 bg-slate-900 p-2 rounded border border-slate-600" value={p.name} onChange={e => setPlayers(players.map(pl => pl.id === p.id ? {...pl, name: e.target.value} : pl))} />
                                                    {players.length > 2 && <button onClick={() => removePlayer(p.id)} className="text-red-500"><Icons.Trash className="w-5 h-5"/></button>}
                                                </div>
                                                <div className="flex gap-2 items-center">
                                                    <Icons.Image className="w-4 h-4 text-slate-400"/>
                                                    <input className="flex-1 bg-slate-900 text-xs p-2 rounded border border-slate-600" placeholder="URL Avatar (https://...)" value={p.avatar} onChange={e => setPlayers(players.map(pl => pl.id === p.id ? {...pl, avatar: e.target.value} : pl))} />
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                    <div className="mt-4 pt-4 border-t border-slate-600 grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="text-xs text-slate-400">Temps (sec)</label>
                                            <input type="number" value={settings.initialTime} onChange={e => setSettings({...settings, initialTime: parseInt(e.target.value)})} className="w-full bg-slate-900 p-2 rounded" />
                                        </div>
                                        <div className="flex items-center gap-2 cursor-pointer" onClick={() => setSettings({...settings, suddenDeath: !settings.suddenDeath})}>
                                            <div className={`w-5 h-5 rounded border ${settings.suddenDeath ? 'bg-red-600 border-red-600' : 'border-slate-400'}`}></div>
                                            <label className="text-xs font-bold text-red-400 flex items-center gap-1"><Icons.Skull className="w-3 h-3"/> Mort Subite</label>
                                        </div>
                                    </div>
                                </div>
                                <div className="card-glass flex-1 p-6 rounded-2xl flex flex-col border-t-4 border-yellow-500">
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="font-bold text-xl">Catégories</h3>
                                        <button onClick={() => setShowImport(true)} className="text-xs bg-purple-600 hover:bg-purple-500 px-3 py-1 rounded flex items-center gap-1"><Icons.Upload className="w-3 h-3"/> Base de Données</button>
                                    </div>
                                    <div className="flex-1 overflow-y-auto grid grid-cols-2 gap-2 content-start">
                                        <button onClick={() => setSelectedCategory("TOUT MÉLANGER")} className={`p-2 rounded text-sm font-bold border-2 ${selectedCategory === "TOUT MÉLANGER" ? 'category-selected' : 'border-slate-600 hover:bg-slate-700'}`}>TOUT MÉLANGER</button>
                                        {Object.values(categories).map(cat => cat !== "TOUT MÉLANGER" && (
                                            <button key={cat} onClick={() => setSelectedCategory(cat)} className={`p-2 rounded text-sm font-bold border-2 ${selectedCategory === cat ? 'category-selected' : 'border-slate-600 hover:bg-slate-700'}`}>{cat}</button>
                                        ))}
                                    </div>
                                    <button onClick={startGame} className="mt-4 w-full bg-gradient-to-r from-yellow-500 to-orange-500 py-4 rounded-xl font-black text-slate-900 text-xl hover:scale-105 transition flex items-center justify-center gap-2"><Icons.Play className="w-6 h-6"/> LANCER LE MATCH</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {gameState === 'playing' && (
                        <div className="flex-1 flex flex-col p-4 max-w-7xl mx-auto w-full">
                            <div className="flex justify-between items-center mb-4">
                                <div className="flex gap-2">
                                    <button onClick={() => setGameState('setup')} className="p-2 bg-slate-800 rounded hover:bg-slate-700"><Icons.Settings className="w-5 h-5"/></button>
                                    <button onClick={() => setSettings({...settings, musicEnabled: !settings.musicEnabled})} className={`p-2 rounded ${settings.musicEnabled ? 'bg-blue-600' : 'bg-slate-800'}`}><Icons.Music className="w-5 h-5"/></button>
                                    <button onClick={() => setIsAdminMode(!isAdminMode)} className={`p-2 rounded ${isAdminMode ? 'bg-red-600 animate-pulse' : 'bg-slate-800'}`}><Icons.Shield className="w-5 h-5"/></button>
                                    {prevState && <button onClick={handleUndo} className="bg-slate-700 text-yellow-400 p-2 rounded flex items-center gap-1 font-bold animate-pulse"><Icons.Undo className="w-5 h-5"/> ANNULER ERREUR</button>}
                                </div>
                                <div className="text-center">
                                    <div className="text-yellow-500 font-black text-2xl tracking-widest">COUP FATAL</div>
                                    <div className="text-xs text-slate-400 bg-slate-800 px-2 rounded">{selectedCategory}</div>
                                </div>
                                <div className="text-right text-xs text-slate-500">Q: <span className="text-white font-bold">{history.length + 1}</span></div>
                            </div>

                            <div className={`grid gap-6 mb-4 flex-1 items-center ${getGridClass()}`}>
                                {players.map((p, idx) => {
                                    const isActive = idx === activePlayerIndex;
                                    const isDanger = p.time < 10 && p.status === 'alive';
                                    const progress = Math.min(100, (p.time / settings.initialTime) * 100);

                                    return (
                                        <div key={p.id} className={`relative p-6 rounded-2xl border-4 flex flex-col items-center justify-center transition-all duration-300 h-full ${isActive ? 'timer-active bg-blue-900/80 scale-105' : 'border-slate-700 bg-slate-800/40 opacity-70'} ${isDanger ? 'timer-danger' : ''} ${p.status === 'eliminated' ? 'grayscale opacity-30' : ''}`}>
                                            <div className="avatar-container">
                                                {p.avatar ? <img src={p.avatar} className="avatar-img" /> : <div className="text-2xl font-bold text-slate-500">{p.name[0]}</div>}
                                            </div>
                                            <h3 className="mt-8 font-bold text-lg">{p.name}</h3>
                                            <div className={`text-6xl font-mono font-black my-2 ${p.time < 5 ? 'text-red-500' : 'text-white'}`}>
                                                {p.status === 'eliminated' ? '---' : <span>{Math.floor(p.time)}<span className="text-sm">.{Math.floor((p.time % 1) * 10)}</span></span>}
                                            </div>
                                            {!p.status === 'eliminated' && <div className="absolute bottom-0 left-0 h-1.5 bg-gradient-to-r from-green-500 to-red-500 transition-all duration-100" style={{width: `${progress}%`}}></div>}
                                            {isActive && !p.status === 'eliminated' && <div className="absolute -bottom-3 bg-yellow-500 text-black text-[10px] font-bold px-3 py-1 rounded-full z-20">EN JEU</div>}
                                            {isAdminMode && (
                                                <div className="absolute -bottom-4 flex gap-1 bg-slate-900 p-1 rounded border border-slate-600 z-50">
                                                    <button onClick={() => adjustTime(p.id, -1)} className="px-2 bg-red-600 text-xs">-1</button>
                                                    <button onClick={() => adjustTime(p.id, 1)} className="px-2 bg-green-600 text-xs">+1</button>
                                                    <button onClick={() => resetPlayerTime(p.id)} className="px-2 bg-blue-600 text-xs"><Icons.RotateCcw className="w-3 h-3"/></button>
                                                </div>
                                            )}
                                        </div>
                                    );
                                })}
                            </div>

                            <div className="flex justify-center mb-4">
                                <button onClick={toggleTimer} className={`px-12 py-4 rounded-full font-black text-2xl shadow-lg flex items-center gap-3 hover:scale-105 transition-all ${isTimerRunning ? 'bg-orange-500 text-white' : 'bg-green-500 text-slate-900 btn-pulse border-4 border-green-300'}`}>
                                    {isTimerRunning ? <><Icons.Pause className="w-8 h-8"/> PAUSE</> : <><Icons.Play className="w-8 h-8"/> TOP ! (Lancer)</>}
                                </button>
                            </div>

                            <div className="w-full max-w-4xl mx-auto card-glass rounded-2xl p-6 border-t-4 border-yellow-500 relative overflow-hidden text-center min-h-[300px] flex flex-col justify-center">
                                <div className="transition-all duration-300">
                                    <div className="flex justify-center gap-2 mb-2">
                                        <span className={`text-xs font-bold px-2 py-1 rounded badge-${qToRender.difficulty || 'Moyen'}`}>{qToRender.difficulty || 'Moyen'}</span>
                                        <span className="text-xs font-bold px-2 py-1 rounded bg-blue-900 text-blue-200">{qToRender.category}</span>
                                    </div>
                                    <h2 className="text-3xl md:text-5xl font-black mb-8 leading-tight">{qToRender.question}</h2>
                                    <div className="bg-black/60 inline-block px-6 py-4 rounded-xl mb-6 border border-slate-600">
                                        <div className="text-xs text-slate-400 uppercase font-bold tracking-widest mb-1">Réponse attendue</div>
                                        <div className="text-3xl text-green-400 font-bold">{qToRender.answer}</div>
                                    </div>
                                </div>
                                <div className="flex gap-4 mt-auto relative z-20 h-24">
                                    <button onClick={handleWrong} className="flex-1 bg-red-600 hover:bg-red-500 rounded-xl font-black text-xl flex flex-col items-center justify-center shadow-lg border-b-8 border-red-800 active:border-b-0 active:translate-y-2 transition-all">
                                        <div className="flex items-center gap-2"><Icons.XCircle className="w-8 h-8"/> MAUVAIS</div>
                                        <span className="text-sm font-normal opacity-80">{settings.suddenDeath && players[activePlayerIndex]?.time < 5 ? '(MORT SUBITE)' : '(Passe)'}</span>
                                    </button>
                                    <button onClick={handleCorrect} className="flex-[2] bg-green-600 hover:bg-green-500 rounded-xl font-black text-3xl flex flex-col items-center justify-center shadow-lg border-b-8 border-green-800 active:border-b-0 active:translate-y-2 transition-all">
                                        <div className="flex items-center gap-3"><Icons.CheckCircle className="w-10 h-10"/> CORRECT</div>
                                        <span className="text-sm font-normal opacity-80 uppercase tracking-widest">Stop Chrono + Suivant</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {gameState === 'ended' && (
                        <div className="flex-1 flex flex-col items-center justify-center p-4">
                            <Icons.Trophy className="w-32 h-32 text-yellow-400 animate-bounce mb-6"/>
                            <h2 className="text-3xl font-light">Vainqueur</h2>
                            <h1 className="text-7xl font-black text-yellow-400 neon-text mb-12">{winner}</h1>
                            <div className="flex gap-4">
                                <button onClick={() => setGameState('setup')} className="bg-slate-700 px-6 py-3 rounded-lg font-bold flex items-center gap-2 hover:bg-slate-600"><Icons.Settings className="w-5 h-5"/> Menu</button>
                                <button onClick={restartGameSamePlayers} className="bg-blue-600 px-6 py-3 rounded-lg font-bold flex items-center gap-2 hover:bg-blue-500 shadow-lg hover:scale-105 transition"><Icons.Zap className="w-5 h-5"/> Revanche Rapide</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>